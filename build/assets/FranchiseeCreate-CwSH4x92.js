import{V,r as u,j as e,W as $,R as Z,T as g}from"./index-C4pKZWoS.js";import{u as H,F as J,C as l}from"./index.esm-BxVMj90r.js";import{t as Q,F as m,z as t}from"./index-pn-TUYJU.js";import{I as d}from"./Input-DmEGxZPQ.js";import{B as U}from"./Button-B7VW5Mw2.js";import{C as X}from"./Card-DOqr0lbN.js";import{B as Y}from"./BottomStickyBar-jdBzbMK-.js";import{u as ee,A as se}from"./useTimeOutMessage-CEVt_o-O.js";import{f as R}from"./index-DGR2MIzj.js";import{S as re}from"./SkuSection-DDOGjxgA.js";import"./classNames-BjbV-B2P.js";import"./index-BAwekRfc.js";import"./isNil-DeLVkTqg.js";import"./StatusIcon-BFlsotSU.js";import"./index-ChdVKN-X.js";import"./CloseButton-DUJuJM1o.js";import"./Select-CdUXWUoL.js";import"./floating-ui.dom-Cyd5NN2V.js";async function ae(){return g.fetchDataWithAxios({url:"/list-sku",method:"get"})}const te=n=>t.object({user_id:t.string(),name:t.string().min(4,"Name Required"),email:t.string().nullish(),phone:t.string().nullish(),city:t.string().nullish(),state:t.string().nullish(),address:t.string().nullish(),pin:t.string().nullish(),gstin:t.string().nullish(),sku_id:t.number().min(1,{message:"SKU required"}),username:t.string().min(4,"Too Short!").max(12,"Too Long!"),password:n?t.string().nullish():t.string().min(1,{message:"Password Required"}).min(6,{message:"Too Short!"}).refine(p=>/^[A-Za-z0-9_-]*$/.test(p),"Only Letters & Numbers Allowed")});async function ne(n){return g.fetchDataWithAxios({url:"/create-franchisee",method:"post",data:n})}async function oe(n){return g.fetchDataWithAxios({url:`/get-franchisee/${n}`,method:"get"})}const Be=()=>{var S,b,v,C,N,B,k,w,A,P,M;const{id:n}=V(),[p,f]=u.useState(!!n),[j,y]=u.useState(null),[W,L]=u.useState([{label:"SKU Name",value:"sku_id",icon:e.jsx(R,{})},,]);u.useEffect(()=>{n&&(f(!0),oe(n).then(s=>{h(s)}).catch(s=>{var i;y(((i=s==null?void 0:s.response)==null?void 0:i.data)||s.toString())})),ae().then(s=>{L((s==null?void 0:s.map(i=>({label:i.name,value:i.id,icon:e.jsx(R,{})})))||[])}).catch(s=>{var i;y(((i=s==null?void 0:s.response)==null?void 0:i.data)||s.toString())}).finally(()=>{f(!1)})},[]);const{handleSubmit:O,reset:h,watch:q,formState:{errors:r},setError:G,control:o}=H({defaultValues:{user_id:"",name:"",email:"",phone:"",city:"",state:"",address:"",pin:"",gstin:"",username:"",password:""},resolver:Q(te(n))}),z=q("sku_id",""),[x,c]=ee(),K=async s=>{var _,D,F,I,T,E;try{n&&(s.id=n);const a=await ne(s);a&&(c==null||c({text:(a==null?void 0:a.message)||"Successfully Saved",type:"success"}),n||h())}catch(a){c==null||c({text:((D=(_=a==null?void 0:a.response)==null?void 0:_.data)==null?void 0:D.message)||a.message.toString()||a.toString(),type:"danger"});for(var i in(I=(F=a==null?void 0:a.response)==null?void 0:F.data)==null?void 0:I.errors)G(i,{type:"manual",message:(E=(T=a==null?void 0:a.response)==null?void 0:T.data)==null?void 0:E.errors[i]})}};return j?e.jsx("div",{children:j.message}):e.jsx(e.Fragment,{children:p?e.jsx($,{loading:!0}):e.jsxs(J,{onSubmit:O(K),children:[e.jsxs(X,{children:[x&&e.jsx(se,{showIcon:!0,className:"mb-4",type:x.type,children:e.jsx("span",{className:"break-all",children:x.text})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{asterisk:!0,label:"User ID",invalid:!!r.user_id,errorMessage:(S=r.user_id)==null?void 0:S.message,children:e.jsx(l,{name:"user_id",control:o,render:({field:s})=>e.jsx(d,{type:"text",autoComplete:"off",placeholder:"Plan User ID",...s})})}),e.jsx(m,{asterisk:!0,label:"Name",invalid:!!r.name,errorMessage:(b=r.name)==null?void 0:b.message,children:e.jsx(l,{name:"name",control:o,render:({field:s})=>e.jsx(d,{type:"text",autoComplete:"off",placeholder:"Franchisee Name",...s})})}),e.jsx(m,{label:"Email",invalid:!!r.email,errorMessage:(v=r.email)==null?void 0:v.message,children:e.jsx(l,{name:"email",control:o,render:({field:s})=>e.jsx(d,{type:"email",autoComplete:"off",placeholder:"e-mail",...s})})}),e.jsx(m,{label:"Phone",invalid:!!r.phone,errorMessage:(C=r.phone)==null?void 0:C.message,children:e.jsx(l,{name:"phone",control:o,render:({field:s})=>e.jsx(d,{type:"number",autoComplete:"off",placeholder:"Phone Number",...s})})}),e.jsx(m,{label:"City",invalid:!!r.city,errorMessage:(N=r.city)==null?void 0:N.message,children:e.jsx(l,{name:"city",control:o,render:({field:s})=>e.jsx(d,{type:"text",autoComplete:"off",placeholder:"City Name",...s})})}),e.jsx(m,{label:"State",invalid:!!r.state,errorMessage:(B=r.state)==null?void 0:B.message,children:e.jsx(l,{name:"state",control:o,render:({field:s})=>e.jsx(d,{type:"text",autoComplete:"off",placeholder:"State Name",...s})})})]}),e.jsxs("div",{children:[e.jsx(m,{label:"Address",invalid:!!r.address,errorMessage:(k=r.address)==null?void 0:k.message,children:e.jsx(l,{name:"address",control:o,render:({field:s})=>e.jsx(d,{type:"text",autoComplete:"off",placeholder:"Address",...s})})}),e.jsx(m,{label:"Pin",invalid:!!r.pin,errorMessage:(w=r.pin)==null?void 0:w.message,children:e.jsx(l,{name:"pin",control:o,render:({field:s})=>e.jsx(d,{type:"number",autoComplete:"off",placeholder:"Pin Number",...s})})}),e.jsx(m,{label:"GSTIN",invalid:!!r.gstin,errorMessage:(A=r.gstin)==null?void 0:A.message,children:e.jsx(l,{name:"gstin",control:o,render:({field:s})=>e.jsx(d,{type:"text",autoComplete:"off",placeholder:"GSTIN",...s})})}),e.jsx(re,{control:o,errors:r,skuOptions:W,selectedSku:z}),e.jsx(m,{asterisk:!0,label:"Username",invalid:!!r.username,errorMessage:(P=r.username)==null?void 0:P.message,children:e.jsx(l,{name:"username",control:o,render:({field:s})=>e.jsx(d,{type:"text",autoComplete:"off",placeholder:"Username",...s})})}),e.jsx(m,{asterisk:!0,label:"Password",invalid:!!r.password,errorMessage:(M=r.password)==null?void 0:M.message,children:e.jsx(l,{name:"password",control:o,render:({field:s})=>e.jsx(d,{type:"password",autoComplete:"off",placeholder:"Password",...s})})})]})]})]}),e.jsx(Y,{children:e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center justify-between px-8",children:[e.jsx("span",{}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{type:"reset",className:"ltr:mr-2 rtl:ml-2",onClick:()=>h(),children:"Reset"}),e.jsx(U,{variant:"solid",type:"submit",children:"Submit"})]})]})})})]})})};export{Be as default};
