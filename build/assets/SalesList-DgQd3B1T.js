import{P as z,r as s,u as F,j as e,X as g,c as A,T as B}from"./index-CZtjPvJ4.js";import{T as M}from"./index-ClRc5ACL.js";import{u as O,g as E,a as I,b as $,c as q,T as H,P as W}from"./index-64zU6N20.js";import{S as _}from"./Select-C_onTc2Z.js";import{e as G}from"./index-TtNNhmIr.js";import{C as L}from"./Card-DhOi8sr1.js";import{B as b}from"./Button-B1TureNB.js";import{B as Q,D as V}from"./Dialog-DM1qDp_-.js";import{T as X,A as J}from"./index-UPzM3flb.js";import{S as K}from"./ScrollBar-D3ZUvQY3.js";import{D as v}from"./index-xmBRuLxb.js";import"./classNames-YaQo_XSq.js";import"./useControllableState-BROaXCl2.js";import"./floating-ui.dom-CrYtpZAi.js";import"./CloseButton-C21If-Yh.js";import"./index-Dskg1t9S.js";import"./useMergeRef-DSPgMaPZ.js";import"./Input-BJOjAQaa.js";import"./isNil-CJvld8F8.js";import"./useUniqueId-CfBq9sDQ.js";import"./toString-BKggjqa2.js";const{Tr:D,Th:i,Td:n,THead:U,TBody:Z}=M;async function S(o,r){return B.fetchDataWithAxios({url:`/get-franchisee-sales-list/${o}/${r.startDate}/${r.endDate}`,method:"get"})}const N=[{value:10,label:"10 / page"},{value:20,label:"20 / page"},{value:30,label:"30 / page"},{value:40,label:"40 / page"},{value:50,label:"50 / page"}],De=()=>{z();const[o,r]=s.useState([]),[y,d]=s.useState(!0),[h,x]=s.useState(null),[m,Y]=s.useState([]),[C,c]=s.useState(!1),[u,P]=s.useState([null,null]),{user:j}=F();s.useEffect(()=>{S(j.id,{startDate:"undefined",endDate:"undefined"}).then(a=>{r(a)}).catch(a=>{var t;x(((t=a==null?void 0:a.response)==null?void 0:t.data)||a.toString())}).finally(()=>{d(!1)})},[]);const p=a=>{a[0]===null||a[1]===null||(d(!0),P(a),S(j.id,{startDate:g(a[0]).format("YYYY-MM-DD"),endDate:g(a[1]).format("YYYY-MM-DD")},transfer).then(t=>{r(t)}).catch(t=>{var f;x(((f=t==null?void 0:t.response)==null?void 0:f.data)||t.toString())}).finally(()=>{d(!1)}))},R=o.length,l=O({data:o,getCoreRowModel:q(),getFilteredRowModel:$(),getPaginationRowModel:I(),getSortedRowModel:E()}),T=a=>{l.setPageIndex(a-1)},w=(a=0)=>{l.setPageSize(Number(a))},k=a=>{Y(a),c(!0)};return h?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:h.message}),e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by date:"}),e.jsx(v.DatePickerRange,{placeholder:"Select dates range",value:u,singleDate:!0,inputFormat:"DD MMM, YYYY",separator:"to",onChange:p,className:"w-64 mb-4 ml-4"})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by date:"}),e.jsx(v.DatePickerRange,{placeholder:"Select dates range",value:u,singleDate:!0,inputFormat:"DD MMM, YYYY",separator:"to",onChange:p,className:"w-64 mb-4 ml-4"})]}),e.jsxs(L,{children:[e.jsxs(M,{children:[e.jsx(U,{children:e.jsxs(D,{children:[e.jsx(i,{children:"Sl No"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Phone"}),e.jsx(i,{children:"City"}),e.jsx(i,{children:"Amount"}),e.jsx(i,{children:"Items"}),e.jsx(i,{children:"Date"})]})}),y?e.jsx(H,{columns:6,rows:10,avatarInColumns:[2,3,5],avatarProps:{width:28,height:28}}):e.jsx(Z,{children:l.getRowModel().rows.map(a=>e.jsxs(D,{children:[e.jsx(n,{children:a.index+1}),e.jsx(n,{children:a.original.name}),e.jsx(n,{children:a.original.phone}),e.jsx(n,{children:a.original.city}),e.jsx(n,{children:a.original.amount}),e.jsx(n,{children:e.jsx("div",{className:"flex items-center",children:e.jsx(Q,{className:"mr-2",innerClass:"bg-blue-500",content:a.original.items.length,children:e.jsx(X,{title:"View items",children:e.jsx(b,{onClick:()=>k(a.original.items),shape:"circle",size:"sm",icon:e.jsx(G,{})})})})})}),e.jsx(n,{children:g.unix(a.original.created_at).format("D MMM, YYYY h:mm a")})]},a.original.id))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx(W,{pageSize:l.getState().pagination.pageSize,currentPage:l.getState().pagination.pageIndex+1,total:R,onChange:T}),e.jsx("div",{style:{minWidth:130},children:e.jsx(_,{size:"sm",isSearchable:!1,value:N.filter(a=>a.value===l.getState().pagination.pageSize),options:N,onChange:a=>w(a==null?void 0:a.value)})})]})]}),e.jsxs(V,{isOpen:C,onClose:()=>c(!1),onRequestClose:()=>c(!1),children:[e.jsx("div",{className:"text-center mb-6",children:e.jsx("h4",{className:"mb-1",children:"Ordered items"})}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"mb-6",children:e.jsx(K,{className:A("overflow-y-auto h-80"),children:m==null?void 0:m.map(a=>e.jsxs("div",{className:"py-3 pr-5 rounded-lg flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{size:"lg",shape:"round",src:a.img_url}),e.jsxs("div",{children:[e.jsx("p",{className:"heading-text font-bold",children:a.name}),e.jsxs("p",{children:["Price: â‚¹",a.amount]})]})]})}),e.jsxs("div",{children:["Qnt:",e.jsx("span",{className:"heading-text font-bold",children:a.quantity})]})]},a.id))})})}),e.jsx(b,{block:!0,type:"button",variant:"solid",onClick:()=>c(!1),children:"Close"})]})]})};export{De as default};
