import{P as B,V as O,r as n,u as E,j as e,X as h,c as I,T as _}from"./index-CZtjPvJ4.js";import{T as P}from"./index-ClRc5ACL.js";import{u as $,g as H,a as q,b as V,c as W,T as G,P as L}from"./index-64zU6N20.js";import{S as Q}from"./Select-C_onTc2Z.js";import{e as X,m as J}from"./index-TtNNhmIr.js";import{C as K}from"./Card-DhOi8sr1.js";import{B as x}from"./Button-B1TureNB.js";import{B as U,D as Z}from"./Dialog-DM1qDp_-.js";import{T as ee,A as ae}from"./index-UPzM3flb.js";import{S as se}from"./ScrollBar-D3ZUvQY3.js";import{D as S}from"./index-xmBRuLxb.js";import"./classNames-YaQo_XSq.js";import"./useControllableState-BROaXCl2.js";import"./floating-ui.dom-CrYtpZAi.js";import"./CloseButton-C21If-Yh.js";import"./index-Dskg1t9S.js";import"./useMergeRef-DSPgMaPZ.js";import"./Input-BJOjAQaa.js";import"./isNil-CJvld8F8.js";import"./useUniqueId-CfBq9sDQ.js";import"./toString-BKggjqa2.js";const{Tr:N,Th:t,Td:i,THead:te,TBody:ie}=P;async function y(d,r,o){return _.fetchDataWithAxios({url:`/get-sales-list/${d}/${r.startDate}/${r.endDate}/${o}`,method:"get"})}const M=[{value:10,label:"10 / page"},{value:20,label:"20 / page"},{value:30,label:"30 / page"},{value:40,label:"40 / page"},{value:50,label:"50 / page"}],Pe=()=>{const d=B(),{transfer:r}=O(),[o,u]=n.useState([]),[C,m]=n.useState(!0),[j,p]=n.useState(null),[g,Y]=n.useState([]),[R,c]=n.useState(!1),[f,T]=n.useState([null,null]),{user:b}=E();n.useEffect(()=>{y(b.id,{startDate:"undefined",endDate:"undefined"},r).then(a=>{u(a)}).catch(a=>{var s;p(((s=a==null?void 0:a.response)==null?void 0:s.data)||a.toString())}).finally(()=>{m(!1)})},[]);const v=a=>{a[0]===null||a[1]===null||(m(!0),T(a),y(b.id,{startDate:h(a[0]).format("YYYY-MM-DD"),endDate:h(a[1]).format("YYYY-MM-DD")},r).then(s=>{u(s)}).catch(s=>{var D;p(((D=s==null?void 0:s.response)==null?void 0:D.data)||s.toString())}).finally(()=>{m(!1)}))},k=o.length,l=$({data:o,getCoreRowModel:W(),getFilteredRowModel:V(),getPaginationRowModel:q(),getSortedRowModel:H()}),w=a=>{l.setPageIndex(a-1)},z=(a=0)=>{l.setPageSize(Number(a))},A=a=>{Y(a),c(!0)},F=a=>{d("/user/invoice2",{state:a})};return j?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:j.message}),e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by date:"}),e.jsx(S.DatePickerRange,{placeholder:"Select dates range",value:f,singleDate:!0,inputFormat:"DD MMM, YYYY",separator:"to",onChange:v,className:"w-64 mb-4 ml-4"})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by date:"}),e.jsx(S.DatePickerRange,{placeholder:"Select dates range",value:f,singleDate:!0,inputFormat:"DD MMM, YYYY",separator:"to",onChange:v,className:"w-64 mb-4 ml-4"})]}),e.jsxs(K,{children:[e.jsxs(P,{children:[e.jsx(te,{children:e.jsxs(N,{children:[e.jsx(t,{children:"Sl No"}),e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Phone"}),e.jsx(t,{children:"City"}),e.jsx(t,{children:"Amount"}),e.jsx(t,{children:"Items"}),e.jsx(t,{children:"Date"}),e.jsx(t,{children:"Action"})]})}),C?e.jsx(G,{columns:6,rows:10,avatarInColumns:[2,3,5],avatarProps:{width:28,height:28}}):e.jsx(ie,{children:l.getRowModel().rows.map(a=>e.jsxs(N,{children:[e.jsx(i,{children:a.index+1}),e.jsx(i,{className:a.original.myshopee_order_id?"text-blue-500":"",children:a.original.name}),e.jsx(i,{children:a.original.phone}),e.jsx(i,{children:a.original.city}),e.jsx(i,{children:a.original.amount}),e.jsx(i,{children:e.jsx("div",{className:"flex items-center",children:e.jsx(U,{className:"mr-2",innerClass:"bg-blue-500",content:a.original.items.length,children:e.jsx(ee,{title:"View items",children:e.jsx(x,{onClick:()=>A(a.original.items),shape:"circle",size:"sm",icon:e.jsx(X,{})})})})})}),e.jsx(i,{children:h.unix(a.original.created_at).format("D MMM, YYYY h:mm a")}),e.jsx(i,{children:e.jsx(x,{onClick:()=>F(a.original),shape:"circle",size:"sm",icon:e.jsx(J,{})})})]},a.original.id))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx(L,{pageSize:l.getState().pagination.pageSize,currentPage:l.getState().pagination.pageIndex+1,total:k,onChange:w}),e.jsx("div",{style:{minWidth:130},children:e.jsx(Q,{size:"sm",isSearchable:!1,value:M.filter(a=>a.value===l.getState().pagination.pageSize),options:M,onChange:a=>z(a==null?void 0:a.value)})})]})]}),e.jsxs(Z,{isOpen:R,onClose:()=>c(!1),onRequestClose:()=>c(!1),children:[e.jsx("div",{className:"text-center mb-6",children:e.jsx("h4",{className:"mb-1",children:"Ordered items"})}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"mb-6",children:e.jsx(se,{className:I("overflow-y-auto h-80"),children:g==null?void 0:g.map(a=>e.jsxs("div",{className:"py-3 pr-5 rounded-lg flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{size:"lg",shape:"round",src:a.img_url}),e.jsxs("div",{children:[e.jsx("p",{className:"heading-text font-bold",children:a.name}),e.jsxs("p",{children:["Price: â‚¹",a.amount]})]})]})}),e.jsxs("div",{children:["Qnt:",e.jsx("span",{className:"heading-text font-bold",children:a.quantity})]})]},a.id))})})}),e.jsx(x,{block:!0,type:"button",variant:"solid",onClick:()=>c(!1),children:"Close"})]})]})};export{Pe as default};
